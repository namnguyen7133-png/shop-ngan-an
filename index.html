<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8">
<title>Shop NgÃ¢n An</title>
<meta name="viewport" content="width=device-width, initial-scale=1">
<style>
body{font-family:Arial;margin:10px;background:#fafafa}
.ká»‡{border:1px solid #ddd;padding:10px;margin-bottom:10px;background:#fff}
.admin-only{display:none;margin-top:5px;width:100%}
.admin .admin-only{display:block}
button{padding:8px;margin:5px 0}
</style>
</head>

<body>

<div style="text-align:center">
  <button onclick="unlock()">ğŸ”’ Má» QUáº¢N LÃ</button>
</div>

<h2>ğŸ› Shop NgÃ¢n An</h2>
<div id="shelves"></div>

<script>
/* ===== Cáº¤U HÃŒNH ===== */
const SHOP_NAME = "NgÃ¢n An";
const ADMIN_PASSWORD = "1234";
const CSV_FILE = "database.csv";
const TOTAL_SHELVES = 32;

/* ===== ADMIN ===== */
function unlock(){
  const p = prompt("Nháº­p máº­t kháº©u quáº£n lÃ½:");
  if(p === ADMIN_PASSWORD){
    document.body.classList.add("admin");
    alert("âœ… ÄÃ£ má»Ÿ quáº£n lÃ½");
  }
}

/* ===== LOAD CSV ===== */
fetch(CSV_FILE)
.then(r=>r.text())
.then(text=>{
  const rows = text.trim().split("\n").slice(1);
  const products = rows.map(r=>{
    const [name,price,link] = r.split(",");
    return {name,price,link};
  });
  render(products);
});

/* ===== RENDER Ká»† ===== */
function render(products){
  const box = document.getElementById("shelves");
  box.innerHTML = "";

  for(let i=1;i<=TOTAL_SHELVES;i++){
    const auto = products[(i-1)%products.length];
    const savedLink = localStorage.getItem("ke_"+i);
    const finalLink = savedLink || auto.link;

    box.innerHTML += `
    <div class="ká»‡">
      <b>Ká»‡ ${i}</b><br>
      ${auto.name} â€“ ${auto.price}<br>
      <a href="${finalLink}" target="_blank">ğŸ‘‰ Mua</a>

      <input class="admin-only"
        placeholder="DÃ¡n link Shopee cho ká»‡ ${i}"
        value="${savedLink || ""}"
        onblur="saveLink(${i}, this.value)">
    </div>`;
  }
}

/* ===== LÆ¯U LINK TAY ===== */
function saveLink(i, link){
  if(link && link.startsWith("http")){
    localStorage.setItem("ke_"+i, link);
    alert("âœ… ÄÃ£ lÆ°u link cho ká»‡ " + i + " (F5 khÃ´ng máº¥t)");
    location.reload();
  }
}
</script>

</body>
</html>
